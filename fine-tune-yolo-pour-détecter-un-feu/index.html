<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
  content="Olivier Eeckhoutte">
<meta name="description"
  content="On crée un jupyter notebook:
mkdir yolo-finetune-fire &amp;amp;&amp;amp; cd $_ touch yolo-finetune.ipynb Contenu du Notebook
MY_SECRET_KEY=&amp;#34;...&amp;#34; !pip install ultralytics !pip install roboflow import os import yaml import ultralytics import pandas as pd from roboflow import Roboflow from ultralytics import YOLO from IPython.display import Image, display Contenu Markdown
yolov11s.pt vs yolov11n.pt
Le &amp;ldquo;s&amp;rdquo; signifie &amp;ldquo;small&amp;rdquo; (petit). Modèle plus grand que &amp;ldquo;n&amp;rdquo;, avec plus de couches et de paramètres. Meilleure précision, mais plus lent et plus gourmand en ressources que &amp;ldquo;n&amp;rdquo;." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<script>
  
  
  if (!(window.location.host.startsWith("127.0.0.1")) && !(window.location.host.startsWith("localhost"))) {
    if (window.location.protocol != "https:") {
      console.log("Redirecting to https...")
      window.location.protocol = "https";
    }
  }
</script>


<link rel="canonical" href="https://leandeep.com/fine-tune-yolo-pour-d%C3%A9tecter-un-feu/" />



<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
  #app {
    display: none;
    border-radius: 10px;
    box-shadow: 2px 5px 12px -1px rgba(0, 0, 0, 0.56);
    padding: 20px;
    background-color: white;
    max-width: 500px;
    margin: 15px auto;
    text-align: center;
    min-height: 500px;
  }

  #app input {
    margin: 0 auto;
    float: none;
    width: 100%;
    max-width: 300px;
    padding: 5px 10px;
    border: 2px solid black;
  }

  #app ul {
    margin: 0;
    padding: 0;
  }

  #app li {
    text-align: left;
    padding: 5px 10px;
    width: 100%;
    max-width: 280px;
    margin: 1px auto;
    background-color: white;
    border: 1px solid black;
    list-style: none;
  }
</style>




<title>
  
  Fine-tune Yolo pour détecter un feu :: Lean Deep Tech blog 
  
</title>



<link href="//cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
  type="text/css">



<link rel="stylesheet" href="https://leandeep.com/main.min.44eaa49e743eabd51724579f1d2ece0dac6f56215301d6961ca74092199d4a05.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://leandeep.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://leandeep.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://leandeep.com/favicon-16x16.png">
    <link rel="manifest" href="https://leandeep.com/site.webmanifest">
    <link rel="mask-icon" href="https://leandeep.com/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://leandeep.com/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">

<meta itemprop="name" content="Fine-tune Yolo pour détecter un feu">
<meta itemprop="description" content="On crée un jupyter notebook:
mkdir yolo-finetune-fire &amp;&amp; cd $_ touch yolo-finetune.ipynb Contenu du Notebook
MY_SECRET_KEY=&#34;...&#34; !pip install ultralytics !pip install roboflow import os import yaml import ultralytics import pandas as pd from roboflow import Roboflow from ultralytics import YOLO from IPython.display import Image, display Contenu Markdown
yolov11s.pt vs yolov11n.pt
Le &ldquo;s&rdquo; signifie &ldquo;small&rdquo; (petit). Modèle plus grand que &ldquo;n&rdquo;, avec plus de couches et de paramètres. Meilleure précision, mais plus lent et plus gourmand en ressources que &ldquo;n&rdquo;."><meta itemprop="datePublished" content="2025-07-19T11:36:00+02:00" />
<meta itemprop="dateModified" content="2025-07-19T11:36:00+02:00" />
<meta itemprop="wordCount" content="595"><meta itemprop="image" content="https://leandeep.com"/>
<meta itemprop="keywords" content="Machine Learning,Python," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://leandeep.com"/>

<meta name="twitter:title" content="Fine-tune Yolo pour détecter un feu"/>
<meta name="twitter:description" content="On crée un jupyter notebook:
mkdir yolo-finetune-fire &amp;&amp; cd $_ touch yolo-finetune.ipynb Contenu du Notebook
MY_SECRET_KEY=&#34;...&#34; !pip install ultralytics !pip install roboflow import os import yaml import ultralytics import pandas as pd from roboflow import Roboflow from ultralytics import YOLO from IPython.display import Image, display Contenu Markdown
yolov11s.pt vs yolov11n.pt
Le &ldquo;s&rdquo; signifie &ldquo;small&rdquo; (petit). Modèle plus grand que &ldquo;n&rdquo;, avec plus de couches et de paramètres. Meilleure précision, mais plus lent et plus gourmand en ressources que &ldquo;n&rdquo;."/>





<meta property="article:published_time" content="2025-07-19 11:36:00 &#43;0200 CEST" />







    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://leandeep.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/leandeep</span>
            <span class="logo__cursor" style=""></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://leandeep.com/events/">Featured Articles</a></li><li><a href="https://leandeep.com/posts/">All Articles</a></li><li><a href="https://leandeep.com/about/">About Me</a></li><li><a href="https://leandeep.com/other/">Other</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>

            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>3 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="https://leandeep.com/fine-tune-yolo-pour-d%C3%A9tecter-un-feu/">Fine-tune Yolo pour détecter un feu</a>
            </h1>

            

            <div class="post-content">
                <p>On crée un jupyter notebook:</p>
<pre tabindex="0"><code>mkdir yolo-finetune-fire &amp;&amp; cd $_
touch yolo-finetune.ipynb
</code></pre><br/>
<p><strong>Contenu du Notebook</strong></p>
<pre tabindex="0"><code>MY_SECRET_KEY=&#34;...&#34;
</code></pre><pre tabindex="0"><code>!pip install ultralytics
!pip install roboflow
</code></pre><pre tabindex="0"><code>import os
import yaml
import ultralytics
import pandas as pd
from roboflow import Roboflow
from ultralytics import YOLO
from IPython.display import Image, display
</code></pre><br/>
<p><strong>Contenu Markdown</strong></p>
<p>yolov11s.pt vs yolov11n.pt</p>
<p>Le &ldquo;s&rdquo; signifie &ldquo;small&rdquo; (petit). Modèle plus grand que &ldquo;n&rdquo;, avec plus de couches et de paramètres. Meilleure précision, mais plus lent et plus gourmand en ressources que &ldquo;n&rdquo;. yolov11n.pt</p>
<p>Le &ldquo;n&rdquo; signifie &ldquo;nano&rdquo; (très petit). Modèle très léger, moins de couches et de paramètres. Plus rapide et moins gourmand en ressources, mais précision généralement plus faible.</p>
<br/>
<pre tabindex="0"><code>!wget -nc https://github.com/ultralytics/assets/releases/download/v8.3.0/yolo11s.pt
</code></pre><pre tabindex="0"><code>rf = Roboflow(api_key=MY_SECRET_KEY)
#model_version = &#34;yolov8&#34;
model_version = &#34;yolov11&#34;
epoch_count = &#34;2&#34;
os.environ[&#34;EPOCH_COUNT&#34;] = epoch_count
run_dir_name = f&#34;runs_{model_version}&#34;
os.environ[&#34;MODEL_VERSION&#34;] = model_version
os.environ[&#34;RUN_DIR_NAME&#34;] = run_dir_name
base_path = f&#34;/home/olivier/Dev/fire/machine_learning/yolo-finetune-fire&#34;
os.environ[&#34;BASE_PATH&#34;] = base_path
project = rf.workspace(&#34;-jwzpw&#34;).project(&#34;continuous_fire&#34;)
print(f&#34;Downloading model {model_version} in path {base_path}&#34;)
dataset = project.version(6).download(model_version, location=base_path)
</code></pre><pre tabindex="0"><code>if model_version == &#34;yolov8&#34;:
    os.environ[&#34;BASE_MODEL_FILENAME&#34;] = f&#34;{model_version}s.pt&#34;
elif model_version == &#34;yolov11&#34;:
    os.environ[&#34;BASE_MODEL_FILENAME&#34;] = f&#34;yolo11s.pt&#34;
</code></pre><pre tabindex="0"><code>!yolo task=detect mode=train model=$BASE_MODEL_FILENAME data=$BASE_PATH/continuous_fire-6/data.yaml epochs=$EPOCH_COUNT imgsz=640 plots=True project=$BASE_PATH/$RUN_DIR_NAME/detect
</code></pre><pre tabindex="0"><code>runs_path = os.path.join(base_path, f&#34;{run_dir_name}/detect&#34;)

train_dirs = [d for d in os.listdir(runs_path) if d.startswith(&#34;train&#34;)]

train_dirs_sorted = sorted(train_dirs, key=lambda x: int(x.replace(&#34;train&#34;, &#34;&#34;) or &#34;1&#34;))

last_train_dir = train_dirs_sorted[-1]
os.environ[&#34;LAST_TRAIN_DIR&#34;] = last_train_dir
</code></pre><pre tabindex="0"><code>Image(filename=f&#34;{base_path}/{run_dir_name}/detect/{last_train_dir}/results.png&#34;, width=600)
</code></pre><br/>
<p><strong>Contenu Markdown</strong></p>
<p>Le fichier results.csv contient les métriques d’entraînement et de validation pour chaque epoch. Voici comment interpréter les principales colonnes:</p>
<p>epoch: numéro de l’époque (itération complète sur le dataset).</p>
<p>time: temps écoulé pour chaque epoch.</p>
<p>train/box_loss, train/cls_loss, train/dfl_loss: pertes (loss) sur l’entraînement pour la localisation des boîtes, la classification et la distribution des frontières (Dfl).</p>
<p>val/box_loss, val/cls_loss, val/dfl_loss : mêmes pertes mais sur le jeu de validation.
metrics/precision(B) : précision sur la validation (proportion de vraies détections parmi toutes les détections).</p>
<p>metrics/recall(B) : rappel sur la validation (proportion de vraies détections parmi tous les objets à détecter).</p>
<p>metrics/mAP50(B) : moyenne des précisions pour un IoU de 0.5 (métrique clé pour la détection d’objets).</p>
<p>metrics/mAP50-95(B) : mAP moyenne pour des IoU de 0.5 à 0.95 (plus stricte, plus représentative).</p>
<p>lr/pg0, lr/pg1, lr/pg2 : taux d’apprentissage pour différents groupes de paramètres.</p>
<p>À retenir :</p>
<p>Plus les valeurs de metrics/mAP50(B) et metrics/mAP50-95(B) sont élevées, meilleur est le modèle.</p>
<p>Les pertes (loss) doivent généralement diminuer au fil des epochs.</p>
<p>Surveille la différence entre les pertes d’entraînement et de validation pour détecter un éventuel surapprentissage (overfitting).</p>
<p>Pour choisir le meilleur modèle, regarde l’epoch où metrics/mAP50(B) est maximal : c’est à cette epoch que le fichier best.pt est sauvegardé.</p>
<br/>
<pre tabindex="0"><code>!yolo task=detect mode=val model=$BASE_PATH/$RUN_DIR_NAME/detect/$LAST_TRAIN_DIR/weights/best.pt data=$BASE_PATH/continuous_fire-6/data.yaml project=$BASE_PATH/$RUN_DIR_NAME/detect/$LAST_TRAIN_DIR
</code></pre><pre tabindex="0"><code>results_csv = os.path.join(runs_path, last_train_dir, &#34;results.csv&#34;)
if os.path.exists(results_csv):
    df = pd.read_csv(results_csv)
    # On considère que la meilleure performance correspond au meilleur mAP50 sur la validation
    best_idx = df[&#34;metrics/mAP50(B)&#34;].idxmax()
    best_epoch = int(df.loc[best_idx, &#34;epoch&#34;])
    best_map = df.loc[best_idx, &#34;metrics/mAP50(B)&#34;]
    #print(f&#34;Le modèle est le plus performant à l&#39;epoch {best_epoch} avec un mAP50(B) de {best_map:.3f}.&#34;)
    total_epochs = len(df)
    print(f&#34;Le modèle est le plus performant à l&#39;epoch {best_epoch} / {total_epochs} avec un mAP50(B) de {best_map:.3f}.&#34;)
    print(&#34;C&#39;est à cette epoch que le fichier best.pt a été sauvegardé, car il correspond à la meilleure performance sur le jeu de validation (mAP50).&#34;)
    table = df[[&#34;epoch&#34;, &#34;metrics/mAP50(B)&#34;]]
    print(table.to_string(index=False))
else:
    print(&#34;Le fichier results.csv n&#39;existe pas dans le dernier dossier train.&#34;)
</code></pre><pre tabindex="0"><code>val_images_dir = os.path.join(base_path, f&#34;{run_dir_name}/detect&#34;, last_train_dir, &#34;val&#34;)

if os.path.exists(val_images_dir):
    images = [f for f in os.listdir(val_images_dir) if f.lower().endswith((&#39;.jpg&#39;, &#39;.png&#39;))]
    if images:
        for img_name in images:
            img_path = os.path.join(val_images_dir, img_name)
            display(Image(filename=img_path, width=600))
    else:
        print(&#34;Aucune image trouvée dans le dossier de validation.&#34;)
else:
    print(&#34;Le dossier de validation n&#39;existe pas.&#34;)
</code></pre><blockquote>
<p>Personal note: notebook location on AI Server: <code>/home/olivier/Dev/fire/machine_learning</code></p>
</blockquote>
<blockquote>
<p><code>jupyter lab --ip=0.0.0.0 --port=8888 --no-browser --allow-root</code> &lt;- commande à utiliser uniquement en développement (sans donnée de prod)</p>
</blockquote>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://leandeep.com/tags/machine-learning">Machine Learning</a></span><span class="tag"><a href="https://leandeep.com/tags/python">Python</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>595 Mots</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>19 juil.. 2025</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    

                    
                        <span class="button next">
                            <a href="https://leandeep.com/installer-jupyter-lab-sur-ubuntu-22/">
                                <span class="button__text">Installer Jupyter lab sur Ubuntu 22</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>Built by <a href="https://www.linkedin.com/in/oliviereeckhoutte/">Olivier Eeckhoutte</a>,
                Freelance @ LeanDeep <a href="https://leandeep.com/about/">(🍃 company)</a></span>
            <span>Siret: 83825337500011</span>
            <span><a href="https://leandeep.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss">
                        <path d="M4 11a9 9 0 0 1 9 9"></path>
                        <path d="M4 4a16 16 0 0 1 16 16"></path>
                        <circle cx="5" cy="19" r="1"></circle>
                    </svg></a></span>
        </div>
    </div>
</footer>
            
        </div>

        




<script type="text/javascript" src="https://leandeep.com/bundle.min.c184f8481b5847ad1a7d8aa775944fa063f118cb4df68f4eaa3826a2a2e16b26a1ad798f5160210f265c6fbb9a5f19b953fed066ae1ed1092d1858bcff13ae92.js" integrity="sha512-wYT4SBtYR60afYqndZRPoGPxGMtN9o9OqjgmoqLhayahrXmPUWAhDyZcb7uaXxm5U/7QZq4e0QktGFi8/xOukg=="></script>







    </body>
</html>
